    function setActiveTab(tab, pageName) {
        // Mark previous tab as inactive
        const activeTab = document.querySelector('.tab.active');
        if (activeTab) {
            activeTab.classList.remove('active');
        }

        // Mark current tab as active
        tab.classList.add('active');

        // Update current page
        currentPage = pageName;

        // Load chat history for the selected page
        loadChatHistory(pageName);
    }

    function loadChatHistory(pageName) {
        // Clear the chat box
        chatBox.innerHTML = ''; 

        // Get the chat history for the selected page
        const history = chatHistories[pageName] || [];

        // Append each message from history into the chat box
        history.forEach(msg => {
            appendMessage(msg.sender, msg.text, msg.isCode);  // Append the messages
        });

        // Reapply syntax highlighting for all code blocks
        reapplySyntaxHighlighting();
    }

    // Function to handle submission of the coding task
    function submitCodingTask() {
        const codingTask = codingTaskInput.value;

        if (codingTask) {
            appendMessage('User', codingTask);
            codingTaskInput.value = '';  // Clear the input field

            // Save the message to the current page's chat history
            chatHistories[currentPage].push({ sender: 'User', text: codingTask, isCode: false });

            // Send the coding task to the backend
            fetch('https://070f-34-126-156-247.ngrok-free.app/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    ip_address: userIp,
                    page: currentPage,  // Pass current page to the backend
                    message: codingTask  
                }),
            })
            .then(response => response.json())
            .then(data => {
                appendMessage('AI', data.response, true);  // Display AI response with syntax highlighting
                chatHistories[currentPage].push({ sender: 'AI', text: data.response, isCode: true });
            })
            .catch(error => {
                console.error('Error:', error);
                appendMessage('AI', 'An error occurred while processing your request.');
            });
        }
    }

    // Function to reapply syntax highlighting
    function reapplySyntaxHighlighting() {
        setTimeout(() => {
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        }, 10);  // Delay for DOM update
    }
